#setPageTitleParams('title.view.series' $series.identifyingName)

$quickTasks.add({
	"id" : "qt-edit-series",
	"url" : "../edit/$series.id",
	"icon": "books+edit"
})
$quickTasks.add({
	"id" : "qt-delete-series",
	"url" : "../delete/$series.id",
	"icon": "books+delete",
	"confirm" : true
})
#set ($hasWishlistAlbums = $series.ownedAlbumCount != $series.totalAlbumCount)
#if ($hasWishlistAlbums)
	$quickTasks.add({
		"id" : "qt-show-wishlist-albums",
		"url" : "#",
		"icon": "gift+eye"
	})
	## TODO: icon with barred eye
	$quickTasks.add({
		"id" : "qt-hide-wishlist-albums",
		"url" : "#",
		"icon": "gift"
	})
#end
##TODO: QT to add an album to the series
##TODO: QT to add a derivative to the series
##TODO: QT to lend albums if at least one album
##TODO: QT to tag all albums if at least one album
##TODO: QT to remove a tag if at least one album

#@entityDetails()

<div class="mdl-grid">
	<div class="mdl-cell mdl-cell--6-col mdl-cell-4-col-tablet">
		#entityFieldText('field.Series.identifyingName' $series.identifyingName)
	</div>
	<div class="mdl-cell mdl-cell--6-col mdl-cell-4-col-tablet">
		#entityFieldUrl('field.Series.website', $series.website)
	</div>
	<div class="mdl-cell mdl-cell--6-col mdl-cell-4-col-tablet">
		#entityFieldBoolean('field.Series.completed', $series.completed)
	</div>
	<div class="mdl-cell mdl-cell--6-col mdl-cell-4-col-tablet">
		#@entityField('field.Series.albumCount')
			#if ($series.ownedAlbumCount == $series.totalAlbumCount)
				#_p('field.Series.albumCount.count.full', $series.totalAlbumCount)
			#else
				#_p('field.Series.albumCount.count.partial', [ $series.ownedAlbumCount, $series.totalAlbumCount ])
			#end
		#end
	</div>
	<div class="mdl-cell mdl-cell--6-col mdl-cell-4-col-tablet">
		#entityFieldCsvList('field.Series.albumWriters', $series.albumWriters, '../../authors/view/')
		#entityFieldCsvList('field.Series.albumArtists', $series.albumArtists, '../../authors/view/')
		#entityFieldCsvList('field.Series.albumColorists', $series.albumColorists, '../../authors/view/')
	</div>
	<div class="mdl-cell mdl-cell--6-col mdl-cell-4-col-tablet">
		#entityFieldTagList('field.Series.albumTags', $series.albumTags)
		#entityFieldCsvList('field.Series.relatedSeries', $series.relatedSeries, './')
	</div>
	<div class="mdl-cell mdl-cell--6-col mdl-cell-4-col-tablet">
		#entityFieldRichText('field.Series.summary', $series.summary)
	</div>
	<div class="mdl-cell mdl-cell--6-col mdl-cell-4-col-tablet">
		#entityFieldRichText('field.Series.comment', $series.comment)
	</div>
</div>
##TODO: derivatives

#end

##TODO: cover slider or equivalent

#if (!$series.albums.isEmpty())
<div id="dem-series-album-list" class="mdl-grid">

	#foreach($album in $series.albums)
		<div class="mdl-cell mdl-cell--6-col mdl-cell--4-col-tablet #if($album.wishlist)dem-hidden#end">
			<div class="mdl-card mdl-shadow--2dp dem-album-card #if($album.wishlist)dem-album-card--wishlist#end">
				<div class="mdl-card__title">
					<a href="$link.contextPath/albums/view/$album.id" class="mdl-card__title-text">$album.identifyingName</a>
					<button id="button-quick-tasks-album-$album.id" class="mdl-button mdl-js-button mdl-button--icon">
						<i class="dico">ellipsis_v</i>
					</button>
					<div class="mdl-tooltip" for="button-quick-tasks-album-$album.id">#_("quickTasks.title")</div>
					<div class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="button-quick-tasks-album-$album.id">
						<a class="mdl-menu__item" href="$link.contextPath/albums/edit/$album.id">
							#icon('speech_bubble+edit')#_('quickTasks.edit.album')
						</a>
					</div>
				</div>
				<div class="dem-album-card__details">
					## TODO: have some JavaScript to avoid loading images (defer loading) if the layout is small
					## TODO: open thumbnails using colorbox or equivalent.
					#thumbnail($album.cover)
					#entityFieldLinkedModel('field.Album.publisher' $album.publisher)
					#entityFieldLinkedModel('field.Album.collection' $album.collection)
					#entityFieldCsvList('field.Album.writers', $album.writers, "$link.contextPath/author/view/")
					#entityFieldCsvList('field.Album.artists', $album.artists, "$link.contextPath/author/view/")
					#entityFieldTagList('field.Album.tags', $album.tags)
				</div>
			</div>
		</div>
	#end

</div>
#end

#if ($hasWishlistAlbums)
<script type="text/javascript">
	// Handler for show/hide wishlist albums
	jQuery(function () {
		jQuery('#qt-hide-wishlist-albums').hide();
		
		jQuery('#qt-hide-wishlist-albums').click(function (e) {
			e.preventDefault();
			jQuery('#qt-hide-wishlist-albums').hide();
			jQuery('#qt-show-wishlist-albums').show();
			jQuery('.dem-album-card--wishlist').parent().addClass('dem-hidden');
		});
		
		jQuery('#qt-show-wishlist-albums').click(function (e) {
			e.preventDefault();
			jQuery('#qt-hide-wishlist-albums').show();
			jQuery('#qt-show-wishlist-albums').hide();
			jQuery('.dem-album-card--wishlist').parent().removeClass('dem-hidden');
		});
	});
</script>
#end