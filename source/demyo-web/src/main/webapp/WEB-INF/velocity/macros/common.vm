#macro(setPageTitle $labelId)
	#set( $pageTitle = "#_($labelId)" )
#end

#macro(setPageTitleParams $labelId $params)
	#set( $pageTitle = "#_p($labelId $params)" )
#end

#macro(setPageTitleCond $condition $labelIdIfTrue $labelIdIfFalse)
	#if ($condition)
		#setPageTitle($labelIdIfTrue)
	#else
		#setPageTitle($labelIdIfFalse)
	#end
#end

#macro(navMenuItem $id $urlFromRoot $labelId $icon)
<a id="$id" href="$link.contextPath/$urlFromRoot" class="mdl-navigation__link">#icon($icon)#_("$labelId")</a>##
#end

#macro(icon $iconSpec)
	#if ($!iconSpec && $iconSpec != '')
		#set( $sepIndex = $iconSpec.indexOf('+') )
		#if ($sepIndex >= 0)
			#set( $overlayStart = $sepIndex + 1 )
			<span class="dico-stack">
				<i class="dico">$iconSpec.substring(0, $sepIndex)</i>
				<i class="dico dico-overlay">$iconSpec.substring($overlayStart, $iconSpec.length())</i>
			</span>
		#else
			<i class="dico">$iconSpec</i>
		#end
	#else
		<i class="dico dico-placeholder"></i>
	#end
#end

#macro(fab $url $iconSpec)
	<a href="$url" class="dem-fabs__button">
		<button class="mdl-button mdl-js-button mdl-button--fab mdl-js-ripple-effect mdl-button--colored">
	  		## TODO: use material icon rather than FontAwesome, for "add"
	  		#icon($iconSpec)
		</button>
	</a>
#end

#macro(fabs)
	<div class="dem-fabs">
		$bodyContent
	</div>
#end

#macro(tag $tag)
	## Avoid any space that could break the tag across lines
	<a href="$link.contextPath/tags/view/$tag.id" class="dem-tag" style="#if($tag.fgColour)color: $tag.fgColour;#end #if($tag.bgColour)background-color: $tag.bgColour;#end">##
<span class="dem-tag__name">$tag.name</span>##
</a>
#end

## Extract this to MDL helpers if the list of macros grows
#macro(mdlGridCell $sizes)
	#set ($classes = "mdl-cell")
	#set ($classes = "$classes mdl-cell--$sizes[0]-col")
	#if ($sizes[1] != $sizes[0] && $sizes[1] != 0)
		#set ($classes = "$classes mdl-cell--$sizes[1]-col-tablet")
	#end
	#if ($sizes[2] != $sizes[1] && $sizes[2] != 0)
		#set ($classes = "$classes mdl-cell--$sizes[2]-col-phone")
	#end
	<div class="$classes">
		$bodyContent
	</div>
#end

#macro(mdlGridCellCond $sizes $condition)
	#if ($condition)
		#mdlGridCell($sizes)## Relays $bodyContent transparently
	#end
#end

#macro(modelLink $model)
	## Auto-detect URL
	#if ($model.class.simpleName == 'Album')
		#set ($baseUrl = "albums")
	#elseif ($model.class.simpleName == 'Author')
		#set ($baseUrl = "authors")
	#elseif ($model.class.simpleName == 'Collection')
		#set ($baseUrl = "collections")
	#elseif ($model.class.simpleName == 'DerivativeSource')
		#set ($baseUrl = "derivativeSources")
	#elseif ($model.class.simpleName == 'DerivativeType')
		#set ($baseUrl = "derivativeTypes")
	#elseif ($model.class.simpleName == 'Publisher')
		#set ($baseUrl = "publishers")
	#elseif ($model.class.simpleName.startsWith('Series'))
		## Work around proxy name being Series_$$_jvstdc3_3
		#set ($baseUrl = "series")
	#else
		#set ($baseUrl = "_missing_$model.class.simpleName")
	#end
	<a href="$link.contextPath/$baseUrl/view/${model.id}">$model.identifyingName</a>
#end